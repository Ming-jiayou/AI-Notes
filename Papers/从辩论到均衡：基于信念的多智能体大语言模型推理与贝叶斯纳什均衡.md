From Debate to Equilibrium:Belief-Driven Multi-Agent LLM Reasoning via Bayesian Nash Equilibrium

从辩论到均衡：基于信念的多智能体大语言模型推理与贝叶斯纳什均衡

摘要 

多智能体框架可显著提升大型语言模型（LLMs）的推理能力，但通常伴随着高昂的计算成本，且缺乏收敛性保证。为应对这些挑战，我们把多LLM的协调过程重新定义为一个不完全信息博弈，并寻求贝叶斯纳什均衡（BNE），在该均衡下，每个智能体根据其对其他智能体策略的概率信念，做出最优响应。我们提出了基于纳什均衡的高效协调方法（ECON），这是一种分层强化学习范式，将分布式推理与集中式最终输出相结合。在ECON框架下，每个LLM独立选择响应，以在给定其对协同智能体信念的条件下最大化预期奖励，且无需昂贵的智能体间交互。我们从数学上证明，ECON相比非均衡的多智能体方案具有显著更紧的后悔界。实证结果表明，ECON在涵盖复杂推理与规划任务的六个基准上，平均性能优于现有多LLM方法11.2%。进一步实验验证了ECON灵活集成额外模型的能力，证明了其可扩展性，为构建更大、更强大的多LLM集成系统铺平了道路。代码已公开于：https://github.com/tmlr-group/ECON。

1 引言  

大型语言模型（LLMs）已在广泛的任务中展现出卓越的推理能力，涵盖自然语言理解与生成到复杂问题求解等多个领域。近期研究显示，将多个LLM组织为多智能体框架，可通过无参数更新的协作式上下文讨论进一步放大其推理能力（Du 等，2024；Chan 等，2024；Liang 等，2023；Chen 等，2023；Hong 等，2023；Zhang 等，2023b）。

特别是，多智能体辩论（Multi-Agent Debate, MAD）（Liang 等，2023；Du 等，2024）利用若干LLM智能体之间的结构化论证机制，每位参与者批判性地评估并改进其他智能体的提议，以达成更稳健、共识驱动的解决方案。MAD 已在多种推理场景中展现出超越单智能体方法的性能，提供更清晰的推理依据并降低错误率。

然而，现有多智能体框架面临三大关键障碍，限制了其实际部署：首先，智能体间频繁通信消耗大量令牌（token），导致计算开销高昂（Du 等，2024）；其次，多轮次交换的信息量远超LLM的上下文窗口容量，阻碍了可扩展性（Liu 等，2024b）；第三，由于缺乏明确的协调协议，这些系统的表现甚至可能劣于简单的集成（ensembling）或自一致性方法（Liang 等，2023）。此外，最新研究指出，智能体间的共识阈值对整体性能具有显著影响（Smit 等，2024）。因此，开发一种有理论依据、可扩展的多智能体协调框架既是必要之举，也是尚未解决的挑战。

在本工作中，我们提出“基于纳什均衡的高效协调”（Efficient Coordination via Nash Equilibrium, ECON）——一种将多LLM交互建模为不完全信息博弈的新框架。如图1所示，传统的MAD方法依赖于所有智能体之间密集的逐轮消息传递，带来巨大的计算负担；而ECON则以“信念驱动协调”替代直接通信：每个LLM维护并更新对其他智能体行为的概率性信念，而非发送和接收显式消息。

尤为重要的是，我们将协调过程建模为追求贝叶斯纳什均衡（Bayesian Nash Equilibrium, BNE）：每个LLM基于其对其他智能体行为的信念，选择最优策略。具体而言，每个执行智能体（Execution LLM）通过一个信念网络，将其局部观测和历史轨迹转化为信念状态，并生成最大化预期收益的输出。所有智能体的信念状态由一个“信念编码器”（Belief Encoder）融合为共享的群体级表征，并输入一个中心化混合网络。该网络动态优化每一智能体的信念网络参数，逐步引导整个群体收敛至一个BNE——每个LLM均趋向于稳定策略。通过以信念协调取代昂贵的令牌交换，ECON显著降低了通信开销，同时保持甚至提升了多智能体推理能力。

理论上，我们首先证明了BNE的存在性，随后通过后悔分析（regret analysis）界定了其与最优策略的性能差距。具体而言，ECON达到的后悔上界为 $ O\left( \sqrt{NT} / (1-\gamma) \right) $，其中 $ N $ 为智能体数量，$ T $ 为迭代次数，$ \gamma $ 为折扣因子。相比之下，缺乏均衡保证的现有多智能体框架其后悔上界为线性 $ O(\delta_{\max} T / (1-\gamma)) $。这一更紧致的上界表明，ECON能高效学习近最优策略，且令牌与计算成本远低于现有MAD方法。因此，ECON有效解决了先前多智能体（Wu 等，2024；Yin 等，2023；Lan 等，2024；Yuan 等，2024a）及图推理（Zhou 等，2023b,a；Li 等，2024；Zhou 等，2024b）研究中的可扩展性瓶颈。得益于“局部-全局纳什协调”（中心协调器-执行者）架构，ECON仅需适度的资源增加，即可集成多达九个LLM。

在实证方面，ECON能够稳定地驱动多LLM系统趋向贝叶斯纳什均衡，促进智能体间的协作推理并增强共识。在六个涵盖复杂推理与规划任务的多样化基准上，ECON平均比单智能体基线提升10.9%，比现有多智能体方法提升11.2%，充分证明其优越性。此外，相较三轮MAD协议，ECON平均减少21.4%的令牌使用量。在可扩展性测试中，将执行智能体数量从3个增至9个，性能还额外提升了18.1%，凸显ECON仅以适度资源开销即可实现良好扩展的能力。

本研究的主要贡献总结如下：

- 我们首次为多智能体LLM系统形式化了贝叶斯纳什均衡（BNE），为无需直接通信的高效协调提供了理论基础（第2节）；
- 我们提出了ECON框架，通过信念驱动协调实现BNE，并借助局部-全局纳什机制克服可扩展性瓶颈（第3节）；
- 我们在实证中验证了ECON在单智能体与多智能体方法中的优越性，并证实其可扩展至更大规模智能体集合的能力（第4节）。

6 结论  

在本研究中，我们提出了ECON，一种面向多LLM系统的创新协作推理框架。ECON构建了一种分层协调机制，使多个执行LLM能够在协调LLM的引导下进行分布式推理。该分层协调机制允许每个执行LLM独立运行，拥有自己的信念网络，仅接收来自协调LLM的问题与策略信息。这种设计使多个执行LLM能够协同进行分布式推理，从而实现贝叶斯纳什均衡（BNE）。在六个基准测试上的实验结果表明，ECON相对于单代理方法平均提升了10.9%的性能，充分验证了本框架的鲁棒性与高效性。此外，ECON在保持合理成本的同时，展现出卓越的可扩展潜力。
